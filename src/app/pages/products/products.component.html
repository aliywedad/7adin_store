<html dir="rtl" lang="ar">
  <mat-card class="cardWithShadow">
    <mat-card-content class="mat-card-content">
      <mat-card-title class="title">قائمة المنتجات</mat-card-title>
      
      <!-- Search and Add -->
      <div class="row">
        <div class="col-8">
          <input class="search" placeholder="ابحث عن منتج" />
        </div>
        <div class="col-4">
          <button class="search-btn" (click)="goToAddPage()">
            إضافة منتج
          </button>
        </div>
      </div>

      <!-- Loader -->
      <loading *ngIf="isLoading"></loading>

      <!-- Products Table -->
      <div *ngIf="!isLoading" class="table-responsive">
        <table class="table table-hover">
          <!-- Table Head -->
          <thead>
            <tr>
              <th scope="col">اسم المنتج</th>
              <th scope="col">الوصف</th>
              <th scope="col">سعر الشراء</th>
              <th scope="col">سعر البيع</th>
              <th scope="col">الكمية</th>
              <!-- <th scope="col">المورد</th> -->
              <th scope="col">تاريخ الإنشاء</th>
              <th scope="col" class="text-center">الإجراءات</th>
            </tr>
          </thead>

          <!-- Table Body -->
          <tbody>
            <tr *ngFor="let product of products; trackBy: trackById" class="align-middle">
              <td class="nowrap">{{ product.name }}</td>
              <td class="nowrap">{{ product.description }}</td>
              <td>{{ product.purchase_price | number:'1.0-2' }} MRU</td>
              <td>{{ product.sale_price | number:'1.0-2' }} MRU</td>
              <td>{{ product.stock_quantity }}</td>
              <!-- <td>{{ product.supplier?.name || '---' }}</td> -->
              <td>
                               <html dir="ltr">{{ product.created_at | date:'yyyy-MM-dd HH:mm' }}</html>

              </td>

              <!-- Actions Column -->
              <td class="text-center">
                <button
                  mat-icon-button
                  [matMenuTriggerFor]="menu"
                  aria-label="خيارات المنتج"
                  class="p-0 m-0"
                >
                  <mat-icon>more_vert</mat-icon>
                </button>
                <mat-menu #menu="matMenu">
                  <button mat-menu-item (click)="goToAddPage()">
                    <mat-icon>add</mat-icon>
                    <span>إضافة</span>
                  </button>
                  <button mat-menu-item (click)="goToEditPage(product.id)">
                    <mat-icon>edit</mat-icon>
                    <span>تعديل</span>
                  </button>
                  <button mat-menu-item (click)="deleteProduct(product.id)">
                    <mat-icon>delete</mat-icon>
                    <span>حذف</span>
                  </button>
                  <button mat-menu-item>
                    <mat-icon>visibility</mat-icon>
                    <span>عرض التفاصيل</span>
                  </button>
                </mat-menu>
              </td>
            </tr>
          </tbody>
        </table>
      </div>
    </mat-card-content>
  </mat-card>
</html>
